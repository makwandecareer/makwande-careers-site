<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login â€¢ Makwande Careers</title>
  <meta name="description" content="Makwande Careers AutoApply platform for SADC." />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
  <link href="/assets/css/style.css" rel="stylesheet" />
</head>
<body>
  <nav class="nav-wrap bg-white sticky-top border-bottom">
    <div class="container-xxl py-2 d-flex align-items-center gap-3">
      <a class="d-flex align-items-center gap-2 text-decoration-none" href="/index.html" aria-label="Makwande Careers home">
        <img src="/assets/img/logo.png" alt="Makwande Careers logo" width="32" height="32" />
        <span class="logo-word">Makwande Careers</span>
      </a>
      <div class="ms-auto d-flex align-items-center gap-3">
        <a class="text-decoration-none nav-link-lite" href="/index.html">Home</a>
        <a class="text-decoration-none nav-link-lite" href="/jobs.html">Jobs</a>
        <a class="text-decoration-none nav-link-lite" href="/revamp.html">Revamp CV</a>
        <a class="text-decoration-none nav-link-lite" href="/cover_letter.html">Cover Letter</a>
        <a class="text-decoration-none nav-link-lite" href="/pricing.html">Pricing</a>
        <a class="text-decoration-none nav-link-lite" href="/dashboard.html">Dashboard</a>
        <a class="text-decoration-none nav-link-lite fw-bold text-success" href="/login.html">Login</a>
        <a class="text-decoration-none nav-link-lite" href="/signup.html">Sign up</a>
      </div>
    </div>
  </nav>


<div class="container-xxl my-4">
  <div class="row justify-content-center">
    <div class="col-md-6 col-lg-5">
      <div class="card p-3">
        <h5 class="mb-3">Login</h5>
        <form id="loginForm" class="vstack gap-2">
          <input class="form-control" name="email" type="email" placeholder="Email" required />
          <input class="form-control" name="password" type="password" placeholder="Password" required />
          <button class="btn btn-success rounded-pill mt-2">Login</button>
        </form>
        <div id="loginMsg" class="small mt-2 text-muted"></div>
      </div>
    </div>
  </div>
</div>


  <footer class="border-top py-4 mt-5">
    <div class="container-xxl d-flex flex-wrap align-items-center justify-content-between gap-3">
      <div class="small text-muted">&copy; <span id="year">2025</span> Makwande Careers All rights reserved</div>
      <div class="d-flex gap-3 small">
        <a href="/index.html">Home</a>
        <a href="/jobs.html">Jobs</a>
        <a href="/privacy.html">Privacy</a>
        <a href="/terms.html">Terms</a>
      </div>
    </div>
  </footer>

  <script>
    window.apiFetch = async function (path, opts={}) {
      const base = "";
      const token = localStorage.getItem("AUTH_TOKEN");
      const headers = Object.assign({}, (opts.headers||{}));
      if (token) headers["Authorization"] = "Bearer " + token;
      const finalOpts = Object.assign({ credentials: "include" }, opts, { headers });
      const res = await fetch(base + path, finalOpts);
      const text = await res.text();
      let data = null; try { data = text ? JSON.parse(text) : null; } catch { data = text; }
      if (!res.ok) throw new Error((data && (data.detail||data.message)) || res.statusText || "Request failed");
      return data;
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
document.getElementById('loginForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const m = document.getElementById('loginMsg');
  m.textContent = "Signing in...";
  const fd = new FormData(e.currentTarget);
  const body = { email: fd.get('email'), password: fd.get('password') };
  try {
    const data = await apiFetch('/api/auth/login', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(body) });
    const token = (data && (data.access_token||data.token)) || null;
    if (token) {
      localStorage.setItem('AUTH_TOKEN', token);
      m.textContent = "Success. Redirecting...";
      setTimeout(()=>location.href='/dashboard.html',800);
    } else {
      m.textContent = "Login ok but no token returned.";
    }
  } catch (err) {
    m.textContent = "Error: " + err.message;
  }
});
</script>

</body>
</html>
