<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Dashboard • AutoApply</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body class="bg-light">
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h4 m-0">Dashboard</h1>
    <button class="btn btn-outline-secondary" onclick="logout()">Logout</button>
  </div>
  <pre id="out" class="bg-white p-3 rounded shadow-sm small">Loading…</pre>
</div>

<script>
const out = document.getElementById('out');

function logout() {
  localStorage.removeItem('AA_TOKEN');
  localStorage.removeItem('AA_USER');
  location.href = '/login.html';
}

(async () => {
  const token = localStorage.getItem('AA_TOKEN');
  if (!token) { location.href = '/login.html'; return; }

  const res = await fetch('/api/me', { headers: { Authorization: `Bearer ${token}` } });
  if (res.status === 401) { logout(); return; }
  const me = await res.json();

  const appsRes = await fetch('/api/applications/protected', { headers: { Authorization: `Bearer ${token}` } });
  const apps = await appsRes.json();

  out.textContent = JSON.stringify({ me, apps }, null, 2);
})();
</script>
</body>
</html>




